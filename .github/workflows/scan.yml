name: Market Scan Notify

on:
  schedule:
    - cron: "30-59/20 14 * * 1-5"
    - cron: "*/20 15-20 * * 1-5"
    - cron: "0 21 * * 1-5"
  workflow_dispatch:

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - name: Call Render Scan API (print response)
        env:
          BASE_URL: ${{ secrets.TAW_BASE_URL }}   # مثال: https://taw-bot.onrender.com
          RUN_KEY:  ${{ secrets.TAW_RUN_KEY }}
        run: |
          set -e
          echo "Calling: $BASE_URL/scan?notify=1"
          curl -f -sS "$BASE_URL/scan?key=$RUN_KEY&notify=1" | tee response.json
          echo ""
          echo "Done"
